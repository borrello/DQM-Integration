process DQM={


    #----------------------------
    #### Event Source
    #-----------------------------
    include "DQM/Integration/test/inputsource_playback.cfi"
    replace EventStreamHttpReader.consumerName = "RPC DQM Consumer"

    #----------------------------
    #### DQM Environment
    #-----------------------------
    include "DQMServices/Core/data/DQM.cfg"
    //replace DQMStore.referenceFileName = "RPC_reference.root"

    include "DQMServices/Components/data/DQMEnvironment.cfi"

    #----------------------------
    #### DQM Playback Environment
    #-----------------------------
    include "DQM/Integration/test/environment_playback.cfi"
    replace dqmEnv.subSystemFolder    = "RPC"
    #-----------------------------


    include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
    include "Geometry/RPCGeometry/data/rpcGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

###############    Raw To Digi:   #########################
#      include "EventFilter/RPCRawToDigi/data/RPCOrconCabling.cfi"



    include "CondCore/DBCommon/data/CondDBSetup.cfi"
    es_source RPCCabling = PoolDBESSource {
      #  using CondDBSetup
      string timetype = "runnumber"
    #  string connect = "frontier://(serverurl=http://frontier1.cms:8000/FrontierOn)(serverurl=http://frontier2.cms:8000/FrontierOn)(retrieve-ziplevel=0)/CMS_COND_20X_RPC"
    
    
    string connect = "frontier://(proxyurl=http://localhost:3128)(serverurl=http://frontier1.cms:8000/FrontierOnProd)(serverurl=http://frontier2.cms:8000/FrontierOnProd)(retrieve-ziplevel=0)/CMS_COND_20X_RPC"
 
 ## if string above is not able to connect to OCRON db please comment line abouve and open the line below:
 ## string connect ="frontier://(serverurl=http://frontier1.cms:8000/FrontierOnProd)(serverurl=http://frontier2.cms:8000/FrontierOnProd)(retrieve-ziplevel=0)/CMS_COND_20X_RPC"
 
     PSet DBParameters = {
	  untracked int32 messageLevel = 0
	  untracked string authenticationPath = "/nfshome0/hltpro/cmssw/cfg/"
      }
      VPSet toGet = {
	{ string record = "RPCEMapRcd" string tag = "RPCEMap_v2" }
      }
      untracked bool siteLocalConfig = false
    }


      module rpcunpacker = RPCUnpackingModule{
         untracked InputTag InputLabel = source
      }

    service = MessageLogger {
      # untracked vstring destinations = {"r2d.log"}
        untracked PSet r2d_46843.log = { untracked string threshold = "FATAL"}
      # untracked vstring debugModules = { "rpcunpacker"}
      # untracked vstring destinations = {"cout"}
    }




####################### RPC Rec Hits ###############################
include "RecoLocalMuon/RPCRecHit/data/rpcRecHits.cfi"
replace rpcRecHits.rpcDigiLabel = "rpcunpacker"

include "DQM/RPCMonitorClient/data/RPCEventSummary.cfi"



    #########################################################
    #### END ################################################
    #########################################################

    include "DQM/RPCMonitorDigi/data/RPCDigiMonitoring.cfi"    
    replace rpcdigidqm.DigiEventsInterval = 100 
    replace rpcdigidqm.dqmshifter =true   	    	
    replace rpcdigidqm.dqmexpert =true		
    replace rpcdigidqm.dqmsuperexpert =false 
    replace rpcdigidqm.DigiDQMSaveRootFile = false

    ########################################################
    ########            Qtest                        #######
    ########################################################

    # run the quality tests as defined in QualityTests.xml    
    module qTesterRPC = QualityTester {
	untracked int32 QualityTestPrescaler = 100
	untracked FileInPath qtList = "DQM/RPCMonitorClient/test/RPCQualityTests.xml"
   }	    

     path p ={rpcunpacker, rpcRecHits,rpcdigidqm, qTesterRPC, dqmEnv ,rpcEventSummary,dqmSaver }

} 
