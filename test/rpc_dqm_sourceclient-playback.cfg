process DQM={
    
    untracked PSet maxEvents = {untracked int32 input = -1}

     source = EventStreamHttpReader{

       string sourceURL = "http://cmsmondev:50082/urn:xdaq-application:lid=29"

       int32 max_event_size = 7000000
       int32 max_queue_depth = 5
       untracked string consumerName = "RPC DQM Source"
       untracked string consumerPriority = "normal"
       untracked int32 headerRetryInterval = 3
       untracked double maxEventRequestRate = 10
#       untracked PSet SelectEvents = { vstring SelectEvents={"PhysicsPath"} }
       untracked PSet SelectEvents = { vstring SelectEvents={"*"} }
     }
 

    include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
    include "Geometry/RPCGeometry/data/rpcGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

###############    Raw To Digi:   #########################
#      include "EventFilter/RPCRawToDigi/data/RPCOrconCabling.cfi"



    include "CondCore/DBCommon/data/CondDBSetup.cfi"
    es_source RPCCabling = PoolDBESSource {
      #  using CondDBSetup
      string timetype = "runnumber"
    #  string connect = "frontier://(serverurl=http://frontier1.cms:8000/FrontierOn)(serverurl=http://frontier2.cms:8000/FrontierOn)(retrieve-ziplevel=0)/CMS_COND_20X_RPC"
    
    
    string connect = "frontier://(proxyurl=http://localhost:3128)(serverurl=http://frontier1.cms:8000/FrontierOnProd)(serverurl=http://frontier2.cms:8000/FrontierOnProd)(retrieve-ziplevel=0)/CMS_COND_20X_RPC"
 
 ## if string above is not able to connect to OCRON db please comment line abouve and open the line below:
 ## string connect ="frontier://(serverurl=http://frontier1.cms:8000/FrontierOnProd)(serverurl=http://frontier2.cms:8000/FrontierOnProd)(retrieve-ziplevel=0)/CMS_COND_20X_RPC"
 
     PSet DBParameters = {
	  untracked int32 messageLevel = 0
	  untracked string authenticationPath = "/nfshome0/hltpro/cmssw/cfg/"
      }
      VPSet toGet = {
	{ string record = "RPCEMapRcd" string tag = "RPCEMap_v2" }
      }
      untracked bool siteLocalConfig = false
    }


      module rpcunpacker = RPCUnpackingModule{
         untracked InputTag InputLabel = source
      }

#################    Data Quality Monitoring:   #########################

   	include "DQMServices/Core/data/DQM.cfg"
	//  replace DQMStore.referenceFileName = "reference file going here"
   	replace DQMStore.verbose = 0	
   	replace DQM.collectorHost = "srv-c2d05-18"
		

    #########################################################
    #### BEGIN DQM Online Environment #######################
    #########################################################

   include "DQMServices/Components/data/DQMEnvironment.cfi"
   replace dqmSaver.convention       = "Online"
   replace dqmSaver.dirName          = "dropbox"
   replace dqmSaver.producer         = "Playback"
   replace dqmEnv.subSystemFolder    = "RPC"

   // replace dqmSaver.saveByLumiSection =  1
   // replace dqmSaver.saveByMinute      = -1
   // replace dqmSaver.saveByEvent       = -1
   replace dqmSaver.saveByRun         =  1
   replace dqmSaver.saveAtJobEnd      = true

   
    #########################################################
    #### END ################################################
    #########################################################

    include "DQM/RPCMonitorDigi/data/RPCDigiMonitoring.cfi"    
    replace rpcdigidqm.DigiEventsInterval = 100 
    replace rpcdigidqm.dqmshifter =true   	    	
    replace rpcdigidqm.dqmexpert =true		
    replace rpcdigidqm.dqmsuperexpert =false 
    replace rpcdigidqm.DigiDQMSaveRootFile = false

    ########################################################
    ########            Qtest                        #######
    ########################################################

    # run the quality tests as defined in QualityTests.xml    
    module qTesterRPC = QualityTester {
	untracked int32 QualityTestPrescaler = 10
	untracked FileInPath qtList = "DQM/RPCMonitorClient/test/RPCQualityTests.xml"
   }	    

    service = MessageLogger {
	untracked vstring destinations = { 
	    "detailedInfo" , "critical" , "cout"
	}
	untracked vstring debugModules = { "*" }
	untracked PSet critical     = { untracked string threshold = "ERROR"   }
	untracked PSet detailedInfo = { untracked string threshold = "INFO"    } 
	untracked PSet cout = {
          untracked string threshold = "WARNING"
           untracked bool noLineBreaks = true
	    untracked PSet WARNING = {untracked int32 limit = 0 }
	}
    }	

     path p ={rpcunpacker, rpcdigidqm,qTesterRPC, dqmEnv ,dqmSaver }

} 
