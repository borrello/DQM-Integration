process DQM={
    
    untracked PSet maxEvents = {untracked int32 input = -1}

    // SM Event Source
     source = NewEventStreamFileReader {
        untracked vstring fileNames = {
            "file:/data1/lookarea/GlobalJu07.00015137.0001.A.storageManager.0.0000.dat"
            "file:/data1/lookarea/GlobalJu07.00015145.0001.A.storageManager.0.0000.dat"
            "file:/data1/lookarea/GlobalJu07.00015148.0001.A.storageManager.0.0000.dat"
        }
     }

    include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
    include "Geometry/RPCGeometry/data/rpcGeometry.cfi"
    include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"

###############    Raw To Digi:   #########################
#      include "EventFilter/RPCRawToDigi/data/RPCOrconCabling.cfi"

    include "CondCore/DBCommon/data/CondDBSetup.cfi"
    es_source RPCCabling = PoolDBESSource {
    #  using CondDBSetup
      string timetype = "runnumber"
      string connect = "frontier://(serverurl=http://frontier1.cms:8000/FrontierOn)(serverurl=http://frontier2.cms:8000/FrontierOn)(retrieve-ziplevel=0)/CMS_COND_ON_170_RPC"
      PSet DBParameters = {
	  untracked int32 messageLevel = 0
	  untracked string authenticationPath = "/nfshome0/hltpro/cmssw/cfg/"
      }
      VPSet toGet = {
	{ string record = "RPCEMapRcd" string tag = "RPCEMap_v2" }
      }
      untracked bool siteLocalConfig = false
    }

  
module rpcunpacker = RPCUnpackingModule{
         untracked InputTag InputLabel = source
         }


#################    Data Quality Monitoring:   #########################
     include "DQMServices/Core/data/DQM.cfg"
     replace DQM.collectorHost = "srv-c2d05-19"


################# BEGIN DQM Online Environment #######################
    include "DQMServices/Components/test/dqm_onlineEnv.cfi"
    replace dqmSaver.convention = "Online"
    replace dqmSaver.fileName      = "RPC"
    replace dqmSaver.dirName       = "/cms/mon/data/dropbox"
    replace dqmSaver.saveAtRunEnd = false
    replace dqmSaver.saveAtJobEnd = true	
    
    replace dqmEnv.subSystemFolder = "RPC"
    replace dqmEnv.eventInfoFolder = "EventInfo"


    # optionally change fileSaving  conditions
    # replace dqmSaver.prescaleLS =   1
    # replace dqmSaver.prescaleTime = -1 # in minutes
    # replace dqmSaver.prescaleEvt =  -1

<<<<<<< rpc_dqm_sourceclient-file.cfg
    #replace dqmSaver.saveAtJobEnd = false
    # will add switch to select histograms to be saved soon
=======



	include "DQMServices/Core/data/DQM.cfg"
	replace DQMStore.verbose = 0
	replace DQM.collectorHost = "srv-c2d05-16"
>>>>>>> 1.5

 
###################### RPC DQM #################################
    include "DQM/RPCMonitorDigi/data/RPCDigiMonitoring.cfi"    
    replace rpcdigidqm.DigiEventsInterval = 100 
    replace rpcdigidqm.dqmshifter =true   	    	
    replace rpcdigidqm.dqmexpert =true		
    replace rpcdigidqm.dqmsuperexpert =false 
    replace rpcdigidqm.DigiDQMSaveRootFile = false
    replace rpcdigidqm.MergeDifferentRuns = true

#################   QTest module  #########################
# run the quality tests as defined in QualityTests.xml    
module qTesterRPC = QualityTester {
	untracked int32 QualityTestPrescaler = 10
	untracked FileInPath qtList = "DQM/RPCMonitorClient/test/RPCQualityTests.xml"
}
	
include "DQM/RPCMonitorClient/data/RPCQualityTests.cfi" 

################### RPC event Summary #######################
include "DQM/RPCMonitorClient/data/RPCEventSummary.cfi"
replace rpcEventSummary.EventInfoPath = "RPC/EventInfo"
replace rpcEventSummary.RPCPrefixDir = "RPC/RecHits"


###################  Logger    ##########################    

    service = MessageLogger {
	untracked vstring destinations = { 
	    "detailedInfo" , "critical" , "cout"
	}
	untracked vstring debugModules = { "*" }
	untracked PSet critical = {untracked string threshold = "ERROR"   }
	untracked PSet detailedInfo = {untracked string threshold = "INFO"    } 
	untracked PSet cout = {
          untracked string threshold = "WARNING"
          untracked bool noLineBreaks = true
	  untracked PSet WARNING = {untracked int32 limit = 0 }
	}
    }	


sequence rpcDigi ={rpcRecHits,rpcdigidqm }
sequence rpcClientQTests ={qTesterRPC,rpcqualitytests,dqmEnv,rpcEventSummary,dqmSaver}

     path p ={rpcDigi, rpcClientQTests}

} 




