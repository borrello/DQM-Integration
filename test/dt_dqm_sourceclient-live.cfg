process DTDQM = {
    
    
    source = EventStreamHttpReader{
	# string sourceURL = "http://srv-c2c07-15.cms:11100/urn:xdaq-application:service=storagemanager"
	string sourceURL = "http://srv-c2d05-14.cms:22100/urn:xdaq-application:lid=30"
	# string sourceURL = "http://cmsdisk1.cms:11100/urn:xdaq-application:service=storagemanager"
	# string sourceURL = "http://cmsmondev:50082/urn:xdaq-application:lid=29"
	int32 max_event_size = 7000000
	int32 max_queue_depth = 5
	untracked string SelectHLTOutput = "out4DQM"
	untracked string consumerName = "DT DQM Source"
	untracked string consumerPriority = "normal"
	untracked int32 headerRetryInterval = 3
	untracked double maxEventRequestRate = 20
	untracked PSet SelectEvents = { vstring SelectEvents={"*DQM"} }
	# untracked PSet SelectEvents = { vstring SelectEvents={"*"} }
    }
    
    untracked PSet maxEvents = {untracked int32 input = -1}
    
    include "DQMServices/Core/data/DQM.cfg"
    
    # official DQMCollector
    replace DQM.collectorHost = "srv-c2d05-19"
    //replace DQM.collectorPort = 9090
    
    ################# BEGIN DQM Online Environment #######################
    include "DQMServices/Components/data/DQMEnvironment.cfi"
    replace dqmSaver.convention       = "Online"
    replace dqmSaver.dirName          = "/home/dqmprolocal/output"
    replace dqmSaver.producer         = "DQM"
    replace dqmEnv.subSystemFolder    = "DT"
    
    // replace dqmSaver.saveByLumiSection =  1
    // replace dqmSaver.saveByMinute      = -1
    // replace dqmSaver.saveByEvent       = -1
    replace dqmSaver.saveByRun         =  1
    replace dqmSaver.saveAtJobEnd      = true
    
    
    include "DQM/Integration/test/dtReco.cff"
    
    service = MessageLogger {
	untracked vstring destinations = { "cout" }
	untracked PSet cout             = { untracked string threshold = "WARNING" }	
    }
    
    
    # Data integrity
    include "DQM/DTMonitorModule/data/dtDataIntegrityTask.cfi"
    include "DQM/DTMonitorClient/data/dtDataIntegrityTest.cfi"
    
    # Digi task
    include "DQM/DTMonitorModule/data/dtDigiTask.cfi"    
    include "DQM/DTMonitorClient/data/dtOccupancyTest.cfi"
    
    # Local Trigger task
    include "DQM/DTMonitorModule/data/dtTriggerTask.cfi"
    include "DQM/DTMonitorClient/data/dtLocalTriggerTest.cfi"
    
     # segment reco task
    include "DQM/DTMonitorModule/data/dtSegmentTask.cfi"
    include "DQM/DTMonitorClient/data/dtSegmentAnalysisTest.cfi"
    
    # report summary
    include "DQM/DTMonitorClient/data/dtSummaryClients.cfi"
     
    module dtqTester = QualityTester {
	untracked FileInPath qtList = "DQM/DTMonitorClient/test/QualityTests.xml"
	untracked int32 prescaleFactor = 1
    }
    
   

    sequence dqmmodules     = { dqmEnv & dqmSaver }
    sequence reco = {dtunpacker & dt1DRecHits & dt4DSegments}
    sequence dtDQMTask      = { dtDigiMonitor & dtTriggerMonitor}
    sequence dtDQMTest =
    { dataIntegrityTest & triggerTest & dtOccupancyTest
	& dtSegmentAnalysisMonitor  & dtSummaryClients & dtqTester}
    
    path dtDQMPath = {dqmmodules & reco & dtDQMTask & segmentTest & dtDQMTest}

}
