
process HCALDQM = { 
	//include "DQM/HcalMonitorModule/data/HcalMonitorModule.cfi"
	//include "DQM/HcalMonitorClient/data/HcalMonitorClient.cfi"
	//include "DQM/HcalMonitorModule/data/Hcal_FrontierConditions_GREN.cff"
        include "DQM/HcalMonitorModule/data/Hcal_FrontierConditions_GRuMM.cff"
	include "FWCore/MessageLogger/data/MessageLogger.cfi"

	include "EventFilter/HcalRawToDigi/data/HcalRawToDigi.cfi"
        include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-hbhe.cfi"
        include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-ho.cfi"
        include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-hf.cfi"
	
	include "DQMServices/Core/data/DQM.cfg"
	replace DQM.collectorHost = "myhost"
	replace DQM.collectorPort = 9092

	path p = { hcalDigis, horeco, hfreco, hbhereco, hcalMonitor, hcalClient, dqmEnv, dqmSaver }

	untracked PSet options = {
		untracked vstring Rethrow = { "ProductNotFound", "TooManyProducts", "TooFewProducts" }
	}
	untracked PSet maxEvents = {untracked int32 input = -1 }
	

	// The last good run of GREN `07
	source = PoolSource {
	        untracked vstring fileNames = {
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/121F13FE-E9A4-DC11-994D-001617DBD272.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/324F1DA3-E5A4-DC11-A732-000423D65A7E.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/34F36443-E9A4-DC11-8C8A-000423D944D4.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/360B4662-E8A4-DC11-B423-001617DBCEF6.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/421BAA91-E8A4-DC11-87A9-001617DBD36C.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/4CE78852-E6A4-DC11-B47A-000423D665B2.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/7637B20C-E8A4-DC11-950A-001617C3B652.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/7832F4A6-E6A4-DC11-AE02-00304856284E.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/943B3531-E7A4-DC11-B67C-001617DBD49A.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/A4C5514F-E5A4-DC11-9BDF-000423D98708.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/D0D20FF6-E7A4-DC11-BBDA-001617DBD2E2.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/D4486B09-E6A4-DC11-AA00-000E0C3F08B7.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/E0481BB5-E7A4-DC11-8BB2-003048561116.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/F016E2D2-E8A4-DC11-AD13-001617DBCFA6.root',
			'/store/data/GlobalNov07/DTHcal/000/030/625/RAW/0000/F2A2C7F7-E6A4-DC11-BF27-000423D59C46.root'
	        }

        }

	// To run on .dat streamer files (you need to change the path to the datafile):
	// source = NewEventStreamFileReader {
        // 	untracked vstring fileNames = {
        // 	    "file:/data1/lookarea/GlobalAug07.00017220.0001.A.storageManager.0.0000.dat",
        // 	    "file:/data1/lookarea/GlobalAug07.00017220.0002.A.storageManager.0.0000.dat",
        // 	    "file:/data1/lookarea/GlobalAug07.00017220.0003.A.storageManager.0.0000.dat"
        // 	}
     	// }
	
	//To run on HCAL local runs:  (you need to have acces to /bigspool or modify the path to the datafile)	
	// source = HcalTBSource {
        //        untracked vstring fileNames = {'file:/bigspool/usc/USC_035349.root'}
	//        untracked vstring streams = { 
	// 		//HBHE a, b, c:
	// 		'HCAL_DCC700','HCAL_DCC701','HCAL_DCC702','HCAL_DCC703','HCAL_DCC704','HCAL_DCC705',
	// 		'HCAL_DCC706','HCAL_DCC707','HCAL_DCC708','HCAL_DCC709','HCAL_DCC710','HCAL_DCC711',
	// 		'HCAL_DCC712','HCAL_DCC713','HCAL_DCC714','HCAL_DCC715','HCAL_DCC716','HCAL_DCC717',
	// 		//HF:
	// 		'HCAL_DCC718','HCAL_DCC719','HCAL_DCC720','HCAL_DCC721','HCAL_DCC722','HCAL_DCC723',
	// 		//HO:
	// 		'HCAL_DCC724','HCAL_DCC725','HCAL_DCC726','HCAL_DCC727','HCAL_DCC728','HCAL_DCC729',
	// 		'HCAL_DCC730','HCAL_DCC731',
	// 		'HCAL_Trigger','HCAL_SlowData'
	// 	}
	// }	




 hcalMonitor = HcalMonitorModule{

		#Determines connection to back-end daemon
		untracked bool MonitorDaemon = true
	       	
		# Verbosity Switch
		untracked bool debug = false

		# Choices for prescaling your module (-1 mean no prescale)
		# Operate every N events
		untracked int32 diagnosticPrescaleEvt = -1
		# Operate every N lumi sections
		untracked int32 diagnosticPrescaleLS  = -1
		# Operate every N minutes
		untracked int32 diagnosticPrescaleTime = -1
		# Operate every N updates
		untracked int32 diagnosticPrescaleUpdate = -1


		# Labels for input products
                InputTag digiLabel = hcalDigis
                InputTag hbheRecHitLabel = hbhereco
                InputTag hfRecHitLabel = hfreco
                InputTag hoRecHitLabel = horeco
  	        InputTag gtLabel = l1GtUnpack

		#Flags for HotCellMonitor.  Thresholds are in GeV

                untracked bool HotCellMonitor = false
                untracked vdouble thresholds={1,1.5,2.,5,15}

                // NADA params updated for Jan DQM challenge using GREN data
                untracked double NADA_Ecand_cut0 = 1.5 // orig values was 1.0
                untracked double NADA_Ecand_cut1 = 2.5 // orig value was 2.5
                untracked double NADA_Ecand_cut2 = 500.
                untracked double NADA_Ecube_cut = 0.5 // orig value was 0.1
                untracked double NADA_Ecell_cut = 0.1
                untracked double NADA_Ecube_frac=0.30 // orig vale was 0.02
                untracked double NADA_Ecell_frac=0.02
                untracked int32 NADA_maxdepth=0
                untracked int32 NADA_maxeta=1
                untracked int32 NADA_maxphi=1
                untracked double NADA_NegCand_cut = -1.5
                
   
                #Flags for DeadCellMonitor
                untracked bool DeadCellMonitor = false
                untracked double coolcellfrac = 0.5 // fraction of cell's neighbors that must be significantly hotter than the cell for the cell to be considered "cool"
                untracked int32 checkNevents = 25 
                untracked double ped_Nsigma = 0
                untracked double minADCcount = 0
                untracked double deadcellfloor = -10. // cells below this energy are automatically set as "cool"
                untracked double deadcellmindiff = 1. // cell must be at least this much below neighbors to be considered a cool cell candidate 

		#Flags for RecHitMonitor.  Threshold is in GeV
	        untracked bool RecHitMonitor = true
	        untracked bool RecHitsPerChannel = false
	        untracked double RecHitOccThresh = 2.0  
	       
		#Flags for DigiMonitor.  Threshold is in ADC counts
		untracked bool DigiMonitor = true
		untracked bool DigisPerChannel = false
		untracked int32 DigiOccThresh = 0

		#Flags for DataFormatMonitor
		untracked bool DataFormatMonitor = true
		untracked int32 dfPrtLvl = 0

		#Flags for MTCCMonitor.  Thresholds are in fC
		#Dump threshold in fC, ranges in iEta/iPhi.  Dumps to stdout
		untracked bool MTCCMonitor = false
		untracked double MTCCOccThresh = 10
		untracked double DumpThreshold = 500
		untracked int32 DumpEtaLow = 0
		untracked int32 DumpEtaHigh = 10
		untracked int32 DumpPhiLow = 10
		untracked int32 DumpPhiHigh = 10
	       
		#Flags for pedestal monitor
	        untracked bool PedestalMonitor = false
	        untracked bool PedestalsPerChannel = false
		untracked bool PedestalsInFC = false

		#Flags for LED monitor
	        untracked bool LEDMonitor = true
	        untracked bool LEDPerChannel = false
		untracked double LED_ADC_Thresh = -1000

		#Flags for TPG monitor
		untracked bool TrigPrimMonitor = true

		#Flags for the hcal template analysis
		untracked bool HcalAnalysis = false

		#Global HCAL DQM parameters.  
		#Sets range of iEta/iPhi plots
		untracked double MaxEta = 41	
		untracked double MinEta = -41	
		untracked double MaxPhi = 73	
		untracked double MinPhi = 0	

		#List of known hot cells to veto using DetId
		untracked vstring HotCells = {}

                untracked bool checkHB=true
                untracked bool checkHE=true
                untracked bool checkHO=true
                untracked bool checkHF=true

                # HotCell Tags for individual subdetectors
                # If these aren't specified, then the global 
                # values are used

                #untracked bool HBdebug = false
                #untracked bool HEdebug = false
                #untracked bool HOdebug = false
                #untracked bool HFdebug = false

                #untracked vdouble HBthresholds={1,1.5,2.,5,15}
                #untracked vdouble HEthresholds={1,1.5,2.,5,15}
                #untracked vdouble HOthresholds={1,1.5,2.,5,15}
                #untracked vdouble HFthresholds={1,1.5,2.,5,15}

                #untracked double HBMaxEta = 41	
 		#untracked double HBMinEta = -41	
		#untracked double HBMaxPhi = 73	
		#untracked double HBMinPhi = 0	

                #untracked double HEMaxEta = 41	
 		#untracked double HEMinEta = -41	
		#untracked double HEMaxPhi = 73	
		#untracked double HEMinPhi = 0	

                #untracked double HOMaxEta = 41	
 		#untracked double HOMinEta = -41	
		#untracked double HOMaxPhi = 73	
		#untracked double HOMinPhi = 0	

                #untracked double HFMaxEta = 41	
 		#untracked double HFMinEta = -41	
		#untracked double HFMaxPhi = 73	
		#untracked double HFMinPhi = 0	

                #untracked double HB_NADA_Ecand_cut0 = 1.
                #untracked double HB_NADA_Ecand_cut1 = 5.
                #untracked double HB_NADA_Ecand_cut2 = 500.
                #untracked double HB_NADA_Ecube_cut = 0.1
                #untracked double HB_NADA_Ecell_cut = 0.1
                #untracked double HB_NADA_Ecube_frac=0.02
                #untracked double HB_NADA_Ecell_frac=0.02
                #untracked int32 HB_NADA_maxdepth=0
                #untracked int32 HB_NADA_maxeta=1
                #untracked int32 HB_NADA_maxphi=1
                #untracked double HB_NADA_NegCand_cut = -1.5
                
                #untracked double HE_NADA_Ecand_cut0 = 1.
                #untracked double HE_NADA_Ecand_cut1 = 5.
                #untracked double HE_NADA_Ecand_cut2 = 500.
                #untracked double HE_NADA_Ecube_cut = 0.1
                #untracked double HE_NADA_Ecell_cut = 0.1
                #untracked double HE_NADA_Ecube_frac=0.02
                #untracked double HE_NADA_Ecell_frac=0.02
                #untracked int32 HE_NADA_maxdepth=0
                #untracked int32 HE_NADA_maxeta=1
                #untracked int32 HE_NADA_maxphi=1
                #untracked double HE_NADA_NegCand_cut = -1.5
                
                #untracked double HO_NADA_Ecand_cut0 = 1.
                #untracked double HO_NADA_Ecand_cut1 = 5.
                #untracked double HO_NADA_Ecand_cut2 = 500.
                #untracked double HO_NADA_Ecube_cut = 0.1
                #untracked double HO_NADA_Ecell_cut = 0.1
                #untracked double HO_NADA_Ecube_frac=0.02
                #untracked double HO_NADA_Ecell_frac=0.02
                #untracked int32 HO_NADA_maxdepth=0
                #untracked int32 HO_NADA_maxeta=1
                #untracked int32 HO_NADA_maxphi=1
                #untracked double HO_NADA_NegCand_cut = -1.5
                
                #untracked double HF_NADA_Ecand_cut0 = 1.
                #untracked double HF_NADA_Ecand_cut1 = 5.
                #untracked double HF_NADA_Ecand_cut2 = 500.
                #untracked double HF_NADA_Ecube_cut = 0.1
                #untracked double HF_NADA_Ecell_cut = 0.1
                #untracked double HF_NADA_Ecube_frac=0.02
                #untracked double HF_NADA_Ecell_frac=0.02
                #untracked int32 HF_NADA_maxdepth=0
                #untracked int32 HF_NADA_maxeta=1
                #untracked int32 HF_NADA_maxphi=1
                #untracked double HF_NADA_NegCand_cut = -1.5
        }





	module hcalClient =  HcalMonitorClient{
		#Determines connection to back-end daemon
		untracked bool MonitorDaemon = true
	       	
		# Verbosity Switch
		untracked bool debug = false

		untracked string processName = ""

		# Choices for prescaling your module (-1 mean no prescale)
		# Operate every N events
		untracked int32 diagnosticPrescaleEvt = 200
		# Operate every N lumi sections
		untracked int32 diagnosticPrescaleLS  = -1
		# Operate every N minutes
		untracked int32 diagnosticPrescaleTime = -1
		# Operate every N updates
		untracked int32 diagnosticPrescaleUpdate = -1

		# Are we running as standalone process?
		untracked bool runningStandalone = false

		# Name of input DQM histogram file
		untracked string inputFile = ""

		# Directory for HTML output
	        # Disabled if set to ""
		untracked string baseHtmlDir = ''


		# Do you want this program to exit at the end of a run?
        untracked bool enableExit = false

		# Reset histograms on these frequencies
	    untracked int32 resetFreqUpdates = -1
	    untracked int32 resetFreqLS = -1
            untracked int32 resetFreqEvents = -1
	    untracked int32 resetFreqTime = -1

		# Analysis jobs to be run
	    untracked bool DataFormatClient = true
	    untracked bool DigiClient = true
	    untracked bool RecHitClient = true
	    untracked bool HotCellClient = false
       	    untracked bool DeadCellClient = false

            # for the moment, don't run CaloTowerClient unless explicitly requested
            untracked bool CaloTowerClient = false

	    untracked bool LEDClient = true
            untracked double LEDRMS_ErrThresh = 0.8
	    untracked double LEDMEAN_ErrThresh = 2.25

	    untracked bool PedestalClient = false
	    untracked bool plotPedRAW = true
	    untracked double PedestalRMS_ErrThresh = 1
	    untracked double PedestalMean_ErrThresh = 2
	    untracked double CapIdRMS_ErrThresh = 0.25
	    untracked double CapIdMEAN_ErrThresh = 1.5

	    untracked bool DoPerChanTests = false

		#Flags for TPG monitor
		untracked bool TrigPrimClient = true

		#Which subdetectors are present?
	    untracked vstring subDetsOn = {'HB', 'HE', 'HF', 'HO'}
      }


	#########################################################
 	#### BEGIN DQM Online Environment #######################
	#########################################################
	# use include file for dqmEnv dqmSaver
	include "DQMServices/Components/test/dqm_onlineEnv.cfi"
	replace dqmSaver.fileName      = "Hcal"
	replace dqmEnv.subSystemFolder = "Hcal"
       
       # optionally change fileSaving  conditions
       // replace dqmSaver.prescaleLS =   -1
       // replace dqmSaver.prescaleTime = -1 # in minutes
       // replace dqmSaver.prescaleEvt =  -1
       // replace dqmSaver.saveAtRunEnd = true
       // replace dqmSaver.saveAtJobEnd = false
       # will add switch to select histograms to be saved soon
   
    #########################################################
    #### END ################################################
    #########################################################
}
